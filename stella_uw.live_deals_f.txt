Option Compare Database
Option Explicit

Private Sub cmd_change_analyst_Click()
    Dim proc_name As String
    proc_name = "live_deals_f.cmd_change_analyst.Click"
    load.call_stack = load.call_stack & vbNewLine & proc_name
    On Error GoTo err_handler
    If load.is_debugging = True Then On Error GoTo 0
    
    load.check_conn_and_variables
    
    With global_vars.data_fields.analyst_id
        global_vars.interfaces.quick_change_f.setup _
        Me!deal_id _
        , .field_name_in_table _
        , "Analyst" _
        , "id" _
        , utilities.twips_converter(0.6, "inch") _
        , Me.Name _
        , load.sources.menu_lists.uws
    End With

outro:
    load.call_stack = ""
    Exit Sub

err_handler:
    Dim err_object As cls_err_object
    Set err_object = New cls_err_object
    With err_object
        .routine_name = proc_name
        .milestone = ""
        .params = ""
        .system_error_code = Err.Number
        .system_error_text = Err.Description
        .show_error_msg = True
        .send_error err_object
    End With
    GoTo outro
End Sub

Private Sub cmd_change_budget_home_Click()
    Dim proc_name As String
    proc_name = "live_deals_f.cmd_change_budget_home.Click"
    load.call_stack = proc_name
    load.check_conn_and_variables
    
    With global_vars.data_fields.budget_home_id
        global_vars.interfaces.quick_change_f.setup _
        Me!deal_id _
        , .field_name_in_table _
        , "Budget home" _
        , "id" _
        , utilities.twips_converter(0.4, "inch") _
        , Me.Name _
        , load.sources.menu_lists.budget_homes
    End With
    
outro:
    load.call_stack = ""
    Exit Sub
End Sub

Private Sub cmd_change_deal_status_Click()
    Dim proc_name As String
    proc_name = "live_deals_f.cmd_change_deal_status.Click"
    load.call_stack = proc_name
    
    load.check_conn_and_variables
    
    With global_vars.data_fields.deal_status_id
        global_vars.interfaces.quick_change_f.setup _
        Me!deal_id _
        , .field_name_in_table _
        , "Deal status" _
        , "id" _
        , utilities.twips_converter(0.6, "inch") _
        , Me.Name _
        , load.sources.menu_lists.deal_statuses
    End With
    
outro:
    load.call_stack = ""
    Exit Sub
    
End Sub

Private Sub cmd_change_nbi_prepper_Click()
    Dim proc_name As String
    proc_name = "live_deals.cmd_change_nbi_prepper.Click"
    load.call_stack = proc_name
    
    load.check_conn_and_variables
    
    With load.deal_details
        If .is_init = False Then .init Me!deal_id
        load.master_deal_list.quick_change .txt_nbi_prepper_id.field_name, "NBI prepper", load.sources.menu_lists.uws, Me!deal_id
    End With
    
outro:
    load.call_stack = ""
    Exit Sub
End Sub

Private Sub cmd_change_primary_uw_Click()
    Dim proc_name As String
    proc_name = "live_deals_f.cmd_change_primary_uw.Click"
    load.call_stack = load.call_stack & vbNewLine & proc_name
    On Error GoTo err_handler
    If load.is_debugging = True Then On Error GoTo 0
    
    load.check_conn_and_variables
    
    With load.deal_details
        If .is_init = False Then .init Me!deal_id
        load.master_deal_list.quick_change .txt_primary_uw_id.field_name, "Primary UW", load.sources.menu_lists.uws, Me!deal_id
    End With

outro:
    load.call_stack = ""
    Exit Sub

err_handler:
    Dim err_object As cls_err_object
    Set err_object = New cls_err_object
    With err_object
        .routine_name = proc_name
        .milestone = ""
        .params = ""
        .system_error_code = Err.Number
        .system_error_text = Err.Description
        .show_error_msg = True
        .send_error err_object
    End With
    GoTo outro
End Sub

Private Sub cmd_change_second_uw_Click()
    Dim proc_name As String
    proc_name = "live_deals_f.cmd_change_second_uw.Click"
    load.call_stack = load.call_stack & vbNewLine & proc_name
    On Error GoTo err_handler
    If load.is_debugging = True Then On Error GoTo 0
    
    load.check_conn_and_variables
    
    global_vars.init_data_fields
    
    With global_vars.data_fields.second_uw_id
        load.master_deal_list.quick_change .field_name_in_table, "Second UW", load.sources.menu_lists.uws, Me!deal_id
    End With

outro:
    load.call_stack = ""
    Exit Sub

err_handler:
    Dim err_object As cls_err_object
    Set err_object = New cls_err_object
    With err_object
        .routine_name = proc_name
        .milestone = ""
        .params = ""
        .system_error_code = Err.Number
        .system_error_text = Err.Description
        .show_error_msg = True
        .send_error err_object
    End With
    GoTo outro
End Sub

Private Sub cmd_change_uw_progress_Click()
    Dim proc_name As String
    proc_name = "live_deals_f.cmd_change_uw_progress.Click"
    load.call_stack = load.call_stack & vbNewLine & proc_name
    On Error GoTo err_handler
    If load.is_debugging = True Then On Error GoTo 0
    
    load.check_conn_and_variables
    
    global_vars.init_data_fields
    
    With global_vars.data_fields.uw_progress
        global_vars.interfaces.quick_change_f.setup Me!deal_id, .field_name_in_table, "UW progress", "txt", utilities.twips_converter(1.6, "inch"), Me.Name
    End With

outro:
    load.call_stack = ""
    Exit Sub

err_handler:
    Dim err_object As cls_err_object
    Set err_object = New cls_err_object
    With err_object
        .routine_name = proc_name
        .milestone = ""
        .params = ""
        .system_error_code = Err.Number
        .system_error_text = Err.Description
        .show_error_msg = True
        .send_error err_object
    End With
    GoTo outro
End Sub

Private Sub cmd_export_deals_Click()
    Dim proc_name As String
    proc_name = "live_deals_f.cmd_export_deals.Click"
    load.call_stack = proc_name
    On Error GoTo err_handler
    If load.is_debugging = True Then On Error GoTo 0
    
    Dim str_milestone As String
    Dim str_sql As String
    
    open_forms.working_on_it_f "Exporting deals." _
    , "'Please wait' says an old sounding voice. You don't know how you know it is old, but you do. It holds the experience of life." _
    & "'Have you eased your tensions today?' the voice asks." & vbNewLine & vbNewLine & "You're thinking maybe you haven't." _
    , 6000
    
    str_sql = Me.RecordSource
    
    Central.open_external_resource_app "reports.accdb"
    
    With load.secondary_access_app
        
        str_milestone = "5"
        .Run "generate_live_deals_extract", str_sql, load.system_info.app_continent
        
        .CloseCurrentDatabase
        
        str_milestone = "6"
        .OpenCurrentDatabase load.system_info.system_paths.common_path & "placeholder.accdb", False
        .Visible = False
    End With
    
outro:
    load.call_stack = ""
    open_forms.working_on_it_f__close
    Exit Sub

err_handler:
    Dim err_object As cls_err_object
    Set err_object = New cls_err_object
    With err_object
        .routine_name = proc_name
        .milestone = ""
        .params = ""
        .system_error_code = Err.Number
        .system_error_text = Err.Description
        .show_error_msg = True
        .send_error err_object
    End With
    GoTo outro
End Sub

Private Sub Form_Load()
    DoCmd.MoveSize Right:=9250, Down:=0, Width:=21000, Height:=6000
End Sub
Private Sub cmdOpenProject_Click()
    load.check_conn_and_variables
    open_forms.deal_details_f Me!deal_id
    
outro:
    load.call_stack = ""
    Exit Sub
    
End Sub

Private Sub header_selector_budget_continent_AfterUpdate()
    Dim proc_name As String
    proc_name = "live_deals_f.header_selector_budget_continent.AfterUpdate"
    load.call_stack = vbNewLine & proc_name
    On Error GoTo err_handler
    If load.is_debugging = True Then On Error GoTo 0
    
    load.check_conn_and_variables
    
    Dim control_name As String
    Dim rs As ADODB.Recordset
    Dim str_sql As String
        
    control_name = global_vars.interfaces.live_deals_f.header_selector_budget_region.field_name
    
    str_sql = load.sources.menu_lists.budget_regions & " WHERE budget_continent_id = " _
    & Me.Controls(global_vars.interfaces.live_deals_f.header_selector_budget_continent.field_name)
    
    Set rs = utilities.create_adodb_rs(conn, str_sql)
    With rs
        .Open
        
        Do While Me.Controls(control_name).ListCount > 0
            Me.Controls(control_name).RemoveItem (0)
        Loop
        
        Me.Controls(control_name).AddItem "0; '_all'"
        Do While rs.EOF = False
            Me.Controls(control_name).AddItem rs!id & ";" & rs!menu_item
            rs.MoveNext
        Loop
        .Close
        Me.Controls(control_name) = 0
    End With
    
    Set rs = Nothing
    
    global_vars.interfaces.live_deals_f.rs_update
    
outro:
    load.call_stack = ""
    Exit Sub

err_handler:
    Dim err_object As cls_err_object
    Set err_object = New cls_err_object
    With err_object
        .routine_name = proc_name
        .milestone = ""
        .params = ""
        .system_error_code = Err.Number
        .system_error_text = Err.Description
        .show_error_msg = True
        .send_error err_object
    End With
    GoTo outro
End Sub

Private Sub header_selector_budget_region_AfterUpdate()
    load.check_conn_and_variables
    global_vars.interfaces.live_deals_f.rs_update
    
outro:
    load.call_stack = ""
    Exit Sub
    
End Sub

Private Sub header_cmd_foreign_deals_Click()
    Dim proc_name As String
    proc_name = "live_deals_f.header_cmd_foreign_deals.Click"
    load.call_stack = load.call_stack & vbNewLine & proc_name
    On Error GoTo err_handler
    If load.is_debugging = True Then On Error GoTo 0
    
    load.check_conn_and_variables
    
    global_vars.interfaces.live_deals_f.change_foreign_deals
    
outro:
    load.call_stack = ""
    open_forms.working_on_it_f__close
    Exit Sub

err_handler:
    Dim err_object As cls_err_object
    Set err_object = New cls_err_object
    With err_object
        .routine_name = proc_name
        .milestone = ""
        .params = ""
        .system_error_code = Err.Number
        .system_error_text = Err.Description
        .show_error_msg = True
        .send_error err_object
    End With
    GoTo outro
End Sub

Private Sub header_cmd_foreign_deals_frame_Click()
    Me!deal_name.SetFocus
End Sub

Private Sub header_selector_uws_AfterUpdate()
    Dim proc_name As String
    proc_name = "live_deals_f.header_selector_uws.AfterUpdate"
    load.call_stack = vbNewLine & proc_name
    On Error GoTo err_handler
    If load.is_debugging = True Then On Error GoTo 0
    
    If Me!header_selector_uws = -1 Then
        Me!header_selector_uws = 0
        GoTo outro
    End If
    
    load.check_conn_and_variables
    
    global_vars.interfaces.live_deals_f.rs_update
    
outro:
    load.call_stack = ""
    Exit Sub

err_handler:
    Dim err_object As cls_err_object
    Set err_object = New cls_err_object
    With err_object
        .routine_name = proc_name
        .milestone = ""
        .params = ""
        .system_error_code = Err.Number
        .system_error_text = Err.Description
        .show_error_msg = True
        .send_error err_object
    End With
    GoTo outro
End Sub

Private Sub header_selector_operational_re_AfterUpdate()
    Dim proc_name As String
    proc_name = "live_deals.header_selector_operational_re.AfterUpdate"
    load.call_stack = vbNewLine & proc_name
    On Error GoTo err_handler
    If load.is_debugging = True Then On Error GoTo 0
    
    load.check_conn_and_variables
    
    global_vars.interfaces.live_deals_f.rs_update
    
outro:
    load.call_stack = ""
    Exit Sub

err_handler:
    Dim err_object As cls_err_object
    Set err_object = New cls_err_object
    With err_object
        .routine_name = proc_name
        .milestone = ""
        .params = ""
        .system_error_code = Err.Number
        .system_error_text = Err.Description
        .show_error_msg = True
        .send_error err_object
    End With
    GoTo outro
End Sub

Private Sub header_selector_risk_type_AfterUpdate()
    Dim proc_name As String
    proc_name = "live_deals_f.header_selector_risk_type.AfterUpdate"
    load.call_stack = vbNewLine & proc_name
    On Error GoTo err_handler
    If load.is_debugging = True Then On Error GoTo 0
    
    load.check_conn_and_variables
    
    global_vars.interfaces.live_deals_f.rs_update
        
outro:
    load.call_stack = ""
    Exit Sub

err_handler:
    Dim err_object As cls_err_object
    Set err_object = New cls_err_object
    With err_object
        .routine_name = proc_name
        .milestone = ""
        .params = ""
        .system_error_code = Err.Number
        .system_error_text = Err.Description
        .show_error_msg = True
        .send_error err_object
    End With
    GoTo outro
End Sub
